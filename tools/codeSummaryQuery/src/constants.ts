import type { ToolConfig, ToolDescription } from '@interrobangc/codellm';

export const vectorDbCollectionName = 'codeSummary' as const;

export const numResults = 15;

export const DEFAULT_CONFIG: ToolConfig = {
  include: ['**/*.ts'],
  exclude: ['**/node_modules/**', '**/dist/**'],
  vectorDbCollectionName,
  vectorDbName: 'chromadb',
} as const;

export const taskPrompt = `Your task is to provide a summary of the code in the context provided to help answer the user's question. If requested, you should also provide relevant code.
`;

export const summarizeTaskPrompt = `
  Your task is to generate an extremely concise summary with minimal prose of the following code file. Keep your summary to 5 sentences or less. Include in your summary:
    - The filename with the path relevant to the project root
    - Dependencies
    - Important functions, classes, and types
    - Relevant information from comments and docs
    - The language used
    - The framework used if you can determine it reliably, if not, do not mention a framework
`;

export const description: ToolDescription = {
  name: 'codeSummaryQuery',
  description: `This tool processes a query generated by an LLM to gather relevant code, full file paths, and code summaries from a vector db collection to provide context to assist the asking LLM in answering a question. It can summarize code and provide relevant code to the asker so that it can answer a question. The query should only include relevant functions, classes, types, and concepts that are relevant to the user's question. The information returned should not be considered comprehensive or precise. This tool is a good starting point for discovering information related to a user's question.`,
  taskPrompt,
  params: [
    {
      name: 'includeCode',
      description: `A flag to determine if relevant code should be included in the response to help you answer the user's question.`,
      type: 'bool',
      required: true,
    },
    {
      name: 'query',
      description: `The query to use to find relevant code and code summaries to help you answer the user's question.`,
      type: 'string',
      required: true,
    },
  ],
} as const;
